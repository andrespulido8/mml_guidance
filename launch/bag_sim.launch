<!-- launch file for MML demo -->
<launch>
	<arg name="aruco_name"            value="/aruco"/>
    <arg name="record_bag" default="false"/>
    <arg name="bag_name" default="/home/andrespulido/Documents/bags/mml"/>

    <!-- launches the quadcopter and the turtlebot with the guidance nodes -->
    <include file="$(find mml_guidance)/launch/mml_sim_estimator.launch" />

	<!-- launches the aruco node that publishes relative pose if robot is in FOV of drone -->
	<group ns="$(arg aruco_name)" >
        <rosparam command="load" file="$(find verify_aruco)/params/body_to_camera.yaml" />
        <!--<rosparam command="load" file="$(find verify_aruco)/params/boardbody_to_aruco.yaml" />-->
		<node pkg="verify_aruco" name="verify_aruco_tf" type="verify_aruco" output="screen">
		<param name ="send_gps" value="true"/>
			<remap from="tf_cam_sim" to="/multirotor/truth/NWU"/>
			<remap from="tf_calib_sim" to="/robot0/odom"/>
			<!--<remap from="tf_estimate_cam" to="/quad/pose_stamped"/>-->
			<param name="publishing_frequency" value="24"/> <!--rate of the charuco published data: 24 is considered as the human eye rate-->
			<param name="azimuth_threshold" value="3.1"/> <!--yaw detection threshold in rad from logitech website (69 deg)-->
			<param name="elevation_threshold" value="3.1"/> <!-- x,y detection threshold in rad from logitech website (42 deg)-->
			<param name="z_threshold" value="3.0"/> <!--altitude detection threshold in meter-->
		</node>
	</group>

	<group if="$(arg record_bag)">
		<!-- record the bag file. Change -O to -o for only prefix instead of full name-->
    	<node name="record" pkg="rosbag" type="record" args="-O $(arg bag_name) robot0/odom multirotor/truth/NWU"/>
	</group>
</launch>
